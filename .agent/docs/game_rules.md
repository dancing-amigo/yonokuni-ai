# ゲームルールと実装ポイント

Yonokuni は 8x8 盤・4 プレイヤー（赤=1, 青=2, 黄=3, 緑=4）が参加するチーム制抽象ボードゲームです。TypeScript/ Python の両実装は共通仕様でシミュレーションされています。

## 基本仕様

- **初期配置**：各プレイヤーは自陣の辺に沿って 6 枚の駒を配置（角を除く）。
- **手番順**：赤 → 青 → 黄 → 緑 →… の順。
- **チーム**：Team A = 赤・黄、Team B = 青・緑。
- **移動**：上下左右へ任意歩数（途中に駒があると移動不可）。

## 捕獲

1. **同色サンド取り（ハサミ取り）**
   - 移動後、横/縦方向に自色の駒で敵駒を挟むと捕獲。
   - 同チーム異色の駒は終端としてカウントされない（壁扱い）。
2. **包囲取り**
   - 手番色以外で連結したグループを探索、全方向に移動自由がない場合そのグループ全捕獲。

## 死に駒（dead）

- 各色が 3 枚以上失うと以降は捕獲不可（移動のみ可）。
- `dead_mask` がボード上の死に駒位置を追跡。

## 中央制覇・勝敗

- 中央 4 マス（[3,3], [3,4], [4,3], [4,4]）を同チームが占有すると即勝利。
- 両チームの駒が死に駒化した場合（同チーム2色とも dead）も敗北条件。
- 手数上限（例: 400 プライ）で引き分け。

## 手番スキップ

- 合法手がない場合は次プレイヤーへスキップ。
- `SelfPlayManager` では死亡ターンなどを統計として保存し可視化。

## 実装参考

- TypeScript: `core/GameStateManager.ts`
- Python: `yonokuni/core/rules.py`, `yonokuni/env/gym_env.py`

いずれも捕獲順序、死亡処理、中央判定などが同一ロジックで実装されているため、学習・運用間で挙動差が生じないようになっています。
